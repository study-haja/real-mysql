# 테이블 풀-아웃

Table Pull out은 세미 조인의 서브쿼리에 사용된 테이블을 아우터 쿼리로 끄집어낸 후에 쿼리를 조인 쿼리로 재작성하는 형태의 최적화이다. 다음 예를 보자.

```mysql
> EXPLAIN
	SELECT * FROM employees e
	WHERE e.emp_no IN ( SELECT de.emp_no FROM dept_emp de WHERE de.dept_no='d009' )
	
--------------------------------------------------------------------------------
| id | select_type | table | type    | key     | key_len | Extra               |
--------------------------------------------------------------------------------
| 1  | SIMPLE      | de    | ref     | PRIMARY | 46012   | Using index         |     
--------------------------------------------------------------------------------
| 1  | SIMPLE      | e     | eq_ref  | PRIMARY | 1       | NULL                |
--------------------------------------------------------------------------------
```

여기서 id값이 서로 1이라는 것은 서부쿼리가 아닌 조인을 했다는 의미이다. 즉 Extra 컬럼에 Using table pullout이라는 문구는 없지만, id 컬럼, 그리고 Extra 문구에 아무것도 출력되지 않는것 등을 보면서 pull out을 사용했는지 안했는지 알 수 있다.

더 확실한 방법으로는 EXPLAIN을 실행한 직후 SHOW WARNING을 보면된다.

다음은 테이블 풀-아웃을 사용할 수 있는 제약 사항이다.

> 1. Table pullout 최적화는 세미 조인 서브쿼리에서만 사용 가능하다.
> 2. Table pullout 최적화는 서브 쿼리 부분이 유니크 인덱스나 프라이머리 키 룩업으로 결과가 1건인 경우에만 사용 가능하다.
> 3. Table pullout이 적용된다 하더라도 기존 쿼리에서 가능했던 최적화 방법이 사용 불가능한 것은 아니므로 MySQL에서는 가능하다면 Table pullOut 최적화를 최대한 적용한다.
> 4. Table pullout 최적화는 서브쿼리의 테이블을 아우터 쿼리로 가져와 조인으로 풀어쓰는 최적화를 수행하는데, 만약 서브쿼리의 모든 테이블이 아우터 쿼리로 끄집어 낼 수 있다면 서브쿼리 자체는 없어진다.
> 5. MySQL에서는 최대한 서브쿼리를 조인으로 풀어서 사용해라 라는 튜닝 가이드가 많은데 Table pullout 최적화는 사실 이 가이드를 그대로 실행하는 것이라, 서브쿼리를 조인으로 풀어서 사용할 필요가 없다.