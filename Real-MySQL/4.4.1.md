## 4.4 MySQL 로그 파일

MySQL 서버에 대한 깊은 내부 지식이 없어도, 로그 파일을 잘 살펴보면 MySQL의 상태나 부하를 일으키는 원인을 쉽게 찾아서 해결할 수 있다.

### 4.4.1 에러 로그 파일

MySQL 설정파일(my.cnf)에서 `log_error` 라는 이름의 파라미터로 정의된 경로에 생성된다.

#### 4.4.1.1 MySQL이 시작하는 과정과 관련된 정보성 및 에러 메시지

MySQL의 설정 파일을 변경하거나 데이터베이스가 비정상적으로 종료된 이후 다시 시작하는 경우에는 반드시 MySQL 에러 로그 파일을 통해 설정된 변수의 이름이나 값이 명확하게 설정되고 의도한 대로 적용됐는지 확인해야 한다.

#### 4.4.1.2 마지막으로 종료할 때 비정상적으로 종료된 경우 나타나는 InnoDB의 트랜젝션 복구 메시지

InnoDB의 경우에는 MySQL 서버가 비정상적 또는 강제적으로 종료됐다면 다시 시작되면서 완료되지 못한 트랜젝션을 정리하고 디스크에 기록되지 못한 데이터가 있다면 다시 기록하는 재처리 작업을 하게 된다. 이 과정에서 문제가 생기면 `innodb_force_recovery` 파라미터를 0보다 큰 값으로 설정하고 재시작해야 한다.

#### 4.4.1.3 쿼리 처리 도중에 발생하는 문제에 대한 에러 메시지

쿼리 도중 발생하는 문제점은 사전예방이 어려우며, 주기적으로 에러 로그 파일을 검토하는 과정에서 알게된다.

#### 4.4.1.4 비정상적으로 종료된 커넥션 메시지(Aborted connection)

클라이언트 애플리케이션에서 정상적으로 접속 종료를 하지 못하고 프로그램이 종료된 경우 MySQL 서버의 에러 로그 파일에 이런 내용이 기록된다. 물론 중간에 네트워크 문제가 있어서 의도하지 않게 접속이 끊어지는 경우에도 이런 메시지가 기록된다. 이런 메시지가 아주 많이 기록된다면 애플리케이션의 커넥션 종료 로직을 한번도 검토할 필요가 있다.

#### 4.4.1.5 InnoDB의 모니터링 또는 상태 조회 명령(SHOW ENGINE INNODB STATUS와 같은)의 결과 메시지

상대적으로 큰 메시지를 로그 파일에 기록하므로, 시스템의 공간을 다 사용해버릴수 있다. 모니터링을 사용한 이후에는 다시 비활성화해서 에러 로그 파일이 커지지 않게 만들어야 한다.

#### 4.4.1.6 MySQL의 종료 메시지

MySQL이 아무도 모르게 종료돼 있거나 때로는 아무도 모르게 재시작하는 경우를 본적이 있을것이다. 이런 경우는 MySQL이 마지막으로 종료되면서 출력한 메시지를 확인하는 것이 원인을 찾는 유일한 방법이다.