### 8.8.4 클러스터링 테이블 사용 시 주의사항

#### 8.8.4.1 클러스터링 인덱스 키의 크기

프라이머리 키의 크기가 클수록, 레코드갯수가 증가하면서 인덱스의 크기가 매우 커진다. 인덱스가 커질수록 그만큼의 메모리가 더 필요해지므로 InnoDB 테이블의 프라이머리 키는 신중하게 선택해야 함.

#### 8.8.4.2 프라이머리 키는 AUTO-INCREMENT보다는 업무적인 칼럼으로 생성(가능한 경우)

InnoDB에서는 프라이머리 키가 클러스터링 키로 사용되기 때문에, 무엇을 프라이머리 키로 사용하느냐에 따라서 검색성능에 엄청난 차이를 만들어 낸다.

설령 그 칼럼의 크기가 크더라도 업무적으로 해당 레코드를 대표할 수 있다면 그 칼럼을 프라이머리 키로 설정하는 것이 좋다.

#### 8.8.4.3 프라이머리 키는 반드시 명시할것

- 프라이머리키가 없는 테이블이라도 내부적으로 일련번호 칼럼을 추가한다, 하지만 이는 사용자에게 노출되지 않는다.

- 반면 사용자가 AUTO_INCREMENT칼럼을 생성하고 프라이머리 키로 설정한다면, 사용자에게 노출되므로 더 좋다.

- 또한 ROW기반의 복제나 InnoDB Cluster에서는 모든 테이블이 프라이머리 키를 가져야만 하는 정상적인 복제성능을 보장하기도 하므로 프라이머리 키는 꼭 생성하는것이 좋다.

#### 8.8.4.4 AUTO-INCREMENT 칼럼을 인조 식별자로 사용할 경우

- 세컨더리 인덱스도 필요하고 프라이머리 키의 길이도 긴 경우에는 AUTO_INCREMENT 칼럼을 추가하고, 이를 프라이머리 키로 설정하면 된다.
- 이렇게 프라이머리 키를 대체하기 위해 인위적으로 추가된 프라이머리 키를 인조 식별자(Surrogate key)라고 한다.
- 로그 테이블과 같이 조회보다는 INSERT 위주의 테이블들은 AUTO_INCREMENT를 이용한 인조 식별자를 프라이머리 키로 설정하는것이 성능에 도움이 된다.



